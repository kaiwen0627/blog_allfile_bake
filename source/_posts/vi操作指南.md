---
title: vi 操作指南
date: 2018-08-21 21:00:38
tags: [linux, shell , git]
categories: linux
---

最近工作中总是与linux、git打交道，不可避免的要使用vim文本编辑器。在此，将一些常见的操作整理出来。做个总结。同时，通过网上查找再加强学习。

## 什么是vi？

>vi(vim)可以说是linux中用得最多的工具了，不管你配置服务也好，写脚本也好，总会用到它。但是，vim作为一个“纯字符”模式下的工具，它的操作和WINDOWS中的文本编辑工具相比多少有些复杂。

## 基本概念

基本上vi可分为三种操作状态，分别是命令模式（Command mode）、插入模式（Insert mode）和底线命令模式（Last line mode），各模式的功能区分如下：

1. Comand mode：控制屏幕光标的移动，字符或光标的删除，移动复制某区段及进入Insert mode下，或者到Last line mode。

2. Insert mode：唯有在Insert mode下，才可做文字数据输入，按Esc等可回到Comand mode。

3. Last line mode：将储存文件或离开编辑器，也可设置编辑环境，如寻找字符串、列出行号等。

***不过可以把vi简化成两个模式，即是将Last line mode也算入Command mode,把vi分成Command 和Insert mode。***

## 基本操作

- 进入vi编辑模式：

    ```bash
    vi text.sh  #在系统提示符号输入vi及文件名称后，即可进入vi全屏幕编辑画面
    ```
- 编辑文件

    ***进入vi之后是处于“Command mode”下，您要切换到Insert mode才能输入文字。***
    >在Command mode下按‘i’、‘a’或‘o’三键就可进入Insert mode。这时候您就可以开始输入文字了。

    + i : 插入，从目前光标所在之处插入所输入的文字。

    + a : 增加，目前光标所在的下一个字开始输入文字。

    + o : 插入新的一行，从行首开始输入文字。

- Insert的切换→Command mode，按Esc键(退出编辑状态)：

        您目前处于Insert mode，您就只能一直打字。假如您发现打错字了，想用光标键往回移动，将该字删除，就要按ESC键转换回Command mode，再删除文字。

- 多行注释/反注释

    1.多行注释：
    - Ctrl+v           进入块级编辑模式
    - 操作光标上下      选取被注释区域
    - 输入I {大写的i}   进入多行插入修改模式
    - 输入#             输入要插入的字符
    - 按ESC            退出多行插入模式
    
    2.取消注释
    - Ctrl+v           进入块级编辑模式
    - 操作光标上下      选取被注释区域
    - 按d删除第一列#号
    - 按ESC            退出多行插入模式

- 离开vi及存文件
在Command mode下，可按冒号“：”键入入Last line mode，例如：

    - :w filename (输入“w filename”，将文章存入指定的文件名filename)

    - :wq (输入“wq”，因为进入之时已经指定文件名testfile，所以会写入testfile并离开vi)

    - :q! (输入“q!”，强制离开并放弃编辑的文件)

## Command mode功能键列表

1. 移动光标

    - 第一种方法：上下左右按键【好像白说了~~】
    - 第二种方法：vi标准按键：
        >h、j、k、l，分别控制光标左、下、上、右移一格。

2. 翻页

    - 按Ctrl+B：屏幕往后移动一页。[常用]
    - 按Ctrl+F：屏幕往前移动一页。[常用]
    - 按Ctrl+U：屏幕往后移动半页。
    - 按Ctrl+D：屏幕往前移动半页。
    - 按 0 （数字零）：移动文章的开头。[常用]
    - 按 G：移动到文章的最后。[常用]
    - 按 w：光标跳到下个word的开头。[常用]
    - 按 e：光标跳到下个word的字尾。
    - 按 b：光标回到上个word的开头。
    - 按 $：移到光标所在行的行尾。[常用]
    - 按 ^：移到该行第一个非空白的字符。
    - 按 0：移到该行的开头位置。[常用]
    - 按 #：移到该行的第#个位置，例：51、121。[常用]

3. 删除文字

    - x：每按一次删除光标所在位置的后面一个字符。[超常用]
    - dd：删除光标所在行。[超常用]
    - yy：复制光标所在行。[超常用]
    - p：复制单行到您想粘贴之处。（指令‘yy’与‘p’必须搭配使用）

4. 撤销操作

    - u：假如您误操作一个指令，可以马上按u，回复到上一个操作。[超常用]

5. 跳至指定行

    - Ctrl+G：列出光标所在行的行号。例如，15G，表示移动光标至文章的第15行行首。[常用]

## Last line mode下指令简介

***先按Esc键确定您已经处于Command mode下后，再按冒号“：”或“/”或“？”三键的其中一键进入Last line mode。***

1. 列出行号
- set nu: 输入“set nu”后，会在文章的每一行前面列出行号。

2. 跳到文章的某一行
- #：井号代表一个数字，在Last line mode提示符号“：”前输入数字，再按Enter就会跳到该行了，如：15[Enter]就会跳到文章的第15行。[常用]

3. 寻找字符串
- /关键字：先按/，再输入您想寻找的字，如果第一次找的关键字不是您相尽可能的，可以一直按n会往下寻找到您要的关键字为止。
- ？关键字：先按？，再输入您想寻找的字，如果第一次找的关键字不是您想要的，可以按n会往前寻找到您要的关键字为止。

4. 取代字符串
- 1，$s/string/replae/g：在last line mode输入“ 1,$s/string/replace/g ”会将全文的string字符串取代为replace字符串，其中1,$s就是指搜寻区间为文章从头至尾的意思，g则是表示全部取代不必确认。
- %s/string/replace/c：同样会将全文的string字符串取代为replace字符串，和上面指令不同的地方是，%s和1,$s是相同的功能，c则是表示要替代之前必须再次确认是否取代。
- 1,20s/string/replace/g：将1至20行间的string替代为relpace字符串。

5. 存文件
- w：在last line mode提示符号“：”前按w即可将文件存起来。[超常用]


6. 离开
- q：按q就离开，有时如果无法离开vi，可搭配“！：强置离开vi，如“q！”
- qw：一般建议离开时，搭配w一起使用，如此离开时还可存文件。[常用]

